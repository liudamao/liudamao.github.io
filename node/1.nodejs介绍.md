# Node.js概念
> 简单来说Nodejs就是运行在服务器端的JavaScript。

## 什么是NodeJS?
javascript是一门脚本语言(可以用来编程的并且直接执行源代码的语言,就是脚本语言),脚本语言都需要一个解析器才能运行。

- 对于写到html中的js，通常是由浏览器去解析执行。
- 对于独立执行的js代码，则需要nodeJS这个解析器解析执行。

Nodejs是一个Javascript运行环境(runtime)。实际上它是对Google V8引擎进行了封装。V8引擎执行Javascript的速度非常快，性能非常好。Nodejs对一些特殊用例进行了优化，提供了替代的API，使得V8在非浏览器环境下运行得更好。

NodeJS是一个让开发者可以快速创建网络应用的服务器端JavaScript平台，同时运用JavaScript进行前端与后端编程，开发者可以更专注于系统的设计以及保持其一致性。

## nodejs特性
### nodejs优势

- 非常快 构建在谷歌Chrome的V8 JavaScript引擎，Node.js代码执行是非常快的。
事件驱动 发生事情执行某种操作。
异步I/O(非阻塞)

- I/O 即 输入与输出
所谓的异步I/O，是相对同步I/O而言的。程序执行过程中必然要进行很多I/O操作，如读写文件、输入输出、请求响应等等。通常来说，I/O操作是非常费时的。例如在传统的编程模式中，你要读一个几G的文件，整个线程都暂停下来，等待文件读完后继续执行。换言之，I/O操作阻塞了代码的执行，极大地降低了程序的效率。

- 单进程，单线程
进程（process）和线程（thread）是操作系统的基本概念，CPU承担计算，CPU好比一个工厂，进程好比 车间，表示CPU可以运行任务单个任务，进程一般只会运行一个，其他处于非运行状态，线程 就好比工人协同完成一个任务 进程与线程
Node保持了JS在浏览器中单线程的特点。单线程的最大好处是不用像多线程编程那样出处在意状态的同步问题，没有死锁的存在，也没有线程上下文切换的开销。单线程也有其弱点，主要表现在三方面：无法利用多核CPU；错误会引起整个应用退出，应用的健壮性值得考研；大量计算会占用CPU导致无法继续调用异步I/O。

- Node.js库异步和事件驱动 所有API异步是非阻塞。 这意味着一个基于Node.js的服务器不会等待API返回数据。 服务器移动到下一个API后调用它，Node.js事件的一个通知机制有助于服务器，以获得从以API调用的响应。

### nodejs劣势

- 不适合CPU密集型应用； CPU密集型应用给Node带来的挑战主要是：由于JavaScript单线程的原因，如果有长时间运行的计算（比如大循环），将会导致CPU时间片不能释放，使得后续I/O无法发起；
解决方案：分解大型运算任务为多个小任务，使得运算能够适时释放，不阻塞I/O调用的发起；
- 只支持单核CPU，不能充分利用CPU
可靠性低，一旦代码某个环节崩溃，整个系统都崩溃 原因：单进程，单线程
解决方案：
（1）Nnigx反向代理，负载均衡，开多个进程，绑定多个端口； 
（2）开多个进程监听同一个端口，使用cluster模块；
开源组件库质量参差不齐，更新快，向下不兼容


### CommonJS

早在Netscape诞生不久后，JavaScript就一直在探索本地编程的路。无奈那时服务端JavaScript走的路均是参考众多服务器端语言来实现的，在这样的背景之下，一没有特色，二没有实用价值。但是随着JavaScript在前端的应用越来越广泛，以及服务端JavaScript的推动，JavaScript现有的规范十分薄弱，不利于JavaScript大规模的应用。那些以JavaScript为宿主语言的环境中，只有本身的基础原生对象和类型，更多的对象和API都取决于宿主的提供，所以，我们可以看到JavaScript缺少这些功能：

- JavaScript没有模块系统。没有原生的支持密闭作用域或依赖管理。
- JavaScript没有标准库。除了一些核心库外，没有文件系统的API，没有IO流API等。
- JavaScript没有标准接口。没有如Web Server或者数据库的统一接口。
- JavaScript没有包管理系统。不能自动加载和安装依赖。


于是便有了CommonJS(http://www.commonjs.org)规范的出现，其目标是为了构建JavaScript在包括Web服务器，桌面，命令行工具，及浏览器方面的生态系统。

CommonJS试图定义一套普通应用程序使用的API，从而填补Javascript标准库过于简单的不足。CommonJS的终极目标是制定一个像C++标准库一样的规范，使得基于CommonJS API的应用程序可以在不同的环境下运行，就像用C++编写的应用程序可以使用不同的编译器和运行时函数库一样。

CommonJS规范： 模块，包，系统，二进制，控制台，编码，文件系统，套接字，单元测试等。

NodeJS是CommonJS规范最热门的一个实现。
CommonJS制定了解决这些问题的一些规范，而Node.js就是这些规范的一种实现。Node.js自身实现了require方法作为其引入模块的方法，同时NPM也基于CommonJS定义的包规范，实现了依赖管理和模块自动安装等功能。


## 应用场景

实时应用：如在线聊天，实时通知推送等等（如socket.io）

分布式应用：通过高效的并行I/O使用已有的数据

工具类应用：海量的工具，小到前端压缩部署（如grunt），大到桌面图形界面应用程序

游戏类应用：游戏领域对实时和并发有很高的要求（如网易的pomelo框架）

前后端编程语言环境统一：前端开发人员可以非常快速地切入到服务器端的开发